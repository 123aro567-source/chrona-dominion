<!DOCTYPE html>
<html>
<head>
<title>Chrona Dominion - Grand Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { background:#111; color:white; font-family:Arial; text-align:center; margin:0; }
#ui { padding:10px; }
button { padding:8px; margin:5px; }
svg { width:100%; max-width:700px; height:auto; margin-top:10px; }
.region { stroke:white; stroke-width:2; cursor:pointer; transition:0.2s; }
.region:hover { opacity:0.8; }
</style>
</head>
<body>

<h2>üåç Chrona Dominion: Grand Strategy</h2>

<div id="ui">
Gold: <span id="gold"></span> |
Turn: <span id="turn"></span>
<br>
<button onclick="recruit()">Recruit (+5 army / 100 gold)</button>
<button onclick="endTurn()">End Turn</button>
<p id="log"></p>
</div>

<svg viewBox="0 0 800 450">

<!-- Continent Regions (Irregular Shapes) -->

<polygon id="r0" class="region" points="50,60 200,40 240,130 120,170 60,130"/>
<polygon id="r1" class="region" points="260,50 420,70 450,160 320,190 240,130"/>
<polygon id="r2" class="region" points="480,80 700,60 740,180 580,210 450,160"/>

<polygon id="r3" class="region" points="100,220 240,200 260,320 140,360 60,300"/>
<polygon id="r4" class="region" points="280,220 450,210 480,340 330,380 260,320"/>
<polygon id="r5" class="region" points="520,230 720,220 760,350 600,390 480,340"/>

<!-- Army Labels -->
<text id="t0" x="140" y="110" fill="white" text-anchor="middle"/>
<text id="t1" x="350" y="120" fill="white" text-anchor="middle"/>
<text id="t2" x="610" y="130" fill="white" text-anchor="middle"/>
<text id="t3" x="150" y="300" fill="white" text-anchor="middle"/>
<text id="t4" x="360" y="300" fill="white" text-anchor="middle"/>
<text id="t5" x="640" y="310" fill="white" text-anchor="middle"/>

</svg>

<script>
let game = {
  gold: 500,
  turn: 1,
  regions: [
    {owner:"player", army:12},
    {owner:"neutral", army:6},
    {owner:"ai1", army:12},
    {owner:"neutral", army:5},
    {owner:"ai2", army:12},
    {owner:"neutral", army:4}
  ]
};

const neighbors = {
  0:[1,3],
  1:[0,2,4],
  2:[1,5],
  3:[0,4],
  4:[1,3,5],
  5:[2,4]
};

function updateUI(){
  document.getElementById("gold").innerText = game.gold;
  document.getElementById("turn").innerText = game.turn;

  game.regions.forEach((r,i)=>{
    let color="gray";
    if(r.owner==="player") color="#2d6cdf";
    if(r.owner==="ai1") color="#d93b3b";
    if(r.owner==="ai2") color="#2fbf71";

    document.getElementById("r"+i).setAttribute("fill",color);
    document.getElementById("t"+i).textContent=r.army;
  });
}

function attack(index){
  let region = game.regions[index];
  if(region.owner==="player") return;

  let adjacent = neighbors[index].some(n=>game.regions[n].owner==="player");
  if(!adjacent) return;

  let playerPower = neighbors[index]
    .filter(n=>game.regions[n].owner==="player")
    .reduce((sum,n)=>sum+game.regions[n].army,0);

  if(playerPower > region.army){
    region.owner="player";
    region.army=Math.floor(playerPower/2);
    game.gold+=150;
    document.getElementById("log").innerText="Victory!";
  } else {
    document.getElementById("log").innerText="Defeat!";
  }

  checkEnd();
  updateUI();
}

function recruit(){
  if(game.gold>=100){
    game.gold-=100;
    let first = game.regions.find(r=>r.owner==="player");
    if(first) first.army+=5;
  }
  updateUI();
}

function aiTurn(ai){
  game.regions.forEach((r,i)=>{
    if(r.owner!==ai) return;

    neighbors[i].forEach(n=>{
      let target=game.regions[n];
      if(target.owner!==ai && Math.random()>0.6){
        if(r.army>target.army){
          target.owner=ai;
          target.army=Math.floor(r.army/2);
        }
      }
    });
  });
}

function endTurn(){
  aiTurn("ai1");
  aiTurn("ai2");

  game.gold+=game.regions.filter(r=>r.owner==="player").length*50;
  game.turn++;
  checkEnd();
  updateUI();
}

function checkEnd(){
  let playerLand = game.regions.filter(r=>r.owner==="player").length;

  if(playerLand===0){
    alert("üíÄ Your empire has fallen.");
    location.reload();
  }

  if(playerLand===game.regions.length){
    alert("üèÜ WORLD DOMINATION!");
    location.reload();
  }
}

game.regions.forEach((_,i)=>{
  document.getElementById("r"+i).addEventListener("click",()=>attack(i));
});

updateUI();
</script>

</body>
</html>
